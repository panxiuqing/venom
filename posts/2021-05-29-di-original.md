---
title: 依赖注入/缘起
date: 2021-05-29
tags: Java, OOP
---

为了一段逻辑能够被复用，我们会定义一个函数，如果想要把这个函数应用在不同的数据（有共性）上，或者和其他一段逻辑进行交互，我们提出了面向接口编程，只要实现了一组接口，使用这组接口的逻辑就能得到复用。

虽然是面向接口，实际中传递给复用逻辑的依旧是一个实现了该接口的类实例。这里就引出了一个新的问题，实例化树。

因为实例本身可能依赖其他接口，如果在构造函数中自行初始化该依赖，那么最终会实例化一颗依赖树，同时这里的依赖均没法面向接口，因为初始化时只能使用具体的类。并且还有个问题是可能产生循环依赖。

为了解决这个问题，我们提出了依赖倒置，即把依赖通过构造函数的参数传入。到目前为止，局部来看代码都已经面向接口了。现在要面对的新问题是：实例化一个类前，要手动进行它的依赖树的实例化。

然后我们就提出了依赖注入，通过注解自动实例化类，然后通过注解注入依赖。

到了这一步，会有人疑惑那为什么不用静态方法呢？因为所谓的面向对象的类基本沦为代码命名空间。
一方面是因为单元测试，替换某一个接口的实现方便进行单元测试。
另一方面在不同的情况下可以选择多例或单例。
